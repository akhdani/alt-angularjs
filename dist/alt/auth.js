alt.modules.auth=angular.module("alt-auth",["angular-jwt"]).factory("$auth",["$log","$window","jwtHelper",function(t,e,a){return store.set(alt.application+"_token",store.get(alt.application+"_token")||""),store.set(alt.application+"_userdata",store.get(alt.application+"_userdata")||{}),{token:"",userdata:{},login:function(t){"string"==typeof t?(this.token=t,this.userdata=a.decodeToken(this.token)):(this.token="",this.userdata=t),store.set(alt.application+"_token",this.token),store.set(alt.application+"_userdata",this.userdata)},logout:function(){this.token="",this.userdata={},store.set(alt.application+"_token",""),store.set(alt.application+"_userdata",{}),store.set(alt.application+"_filter",""),store.set(alt.application+"_sorting","")},islogin:function(){return""!=this.token?!a.isTokenExpired(this.token):Object.keys(this.userdata).length>0},check:function(t){return 0==t?this.islogin():this.islogin()&&"undefined"!=typeof this.userdata.userlevel&&(parseInt(this.userdata.userlevel)&parseInt(t))>0},set_permission:function(t,a){return a="undefined"!=typeof a?a:!0,this.check(t)?!0:(a&&(e.location.href=alt.baseUrl+"error?code=403"),!1)}}}]).config(["$provide","$httpProvider",function(t,e){t.factory("authHttpInterceptor",["$auth","$log","$q","$window",function(t,e,a,o){return{request:function(e){return console.log("auth",e.data),e.data&&(e.data.token=t.token),e}}}]),e.interceptors.reverse().push("authHttpInterceptor"),e.interceptors.reverse()}]),alt.module("alt-auth",alt.modules.auth);